box: 
  id: golang
  

build:
  steps:
    - setup-go-workspace
    - script:
      name: go get
      code: |
        go get

    - script:
      name: go build
      code: |
        go build ./GeneralWebApi/..

    - script:
      name: go test
      code: |
        go test ./GeneralWebApi/..
deploy:
  steps:
    - internal/store-container:  
    - script:
      name: docker push
      code: |
        docker login vptlabs.azurecr.io -u $USERNAME -p $PASSWORD
        docker tag generalwebapi  vptlabs.azurecr.io/test/generalwebapi
        docker push vptlabs.azurecr.io/test/generalwebapi

# Does not work since docker command not available.. use internal steps
#    - script:
#      name: docker push
#      code: |
#        docker login vptlabs.azurecr.io -u $USERNAME -p $PASSWORD
#        docker tag generalwebapi  vptlabs.azurecr.io/test/generalwebapi
#        docker push vptlabs.azurecr.io/test/generalwebapi
#  - internal/docker-push:
#        username: $USERNAME
#        password: $PASSWORD
#        repository: vptlabs.azurecr.io/lab/generalwebapi
#        registry: https://vptlabs.azurecr.io/


